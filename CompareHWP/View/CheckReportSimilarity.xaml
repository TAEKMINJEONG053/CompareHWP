<UserControl x:Class="CompareHWP.View.CheckReportSimilarity"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:local="clr-namespace:CompareHWP.View"
             mc:Ignorable="d"
             d:DesignHeight="450"
             d:DesignWidth="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="180" />
            <!-- 상단 -->
            <RowDefinition Height="*" />
            <!-- 결과 -->
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <!-- 좌 -->
            <ColumnDefinition Width="1*" />
            <!-- 우 -->
        </Grid.ColumnDefinitions>
        <dxg:GridControl Grid.Row="0"
                         Grid.Column="0"
                         ItemsSource="{Binding FileList}"
                         AllowDrop="True"
                         SelectionMode="Row"
                         SelectedItems="{Binding SelectedFileList}"
                         DragEnter="FileGrid_DragEnter"
                         Drop="FileGrid_Drop">

            <dxg:GridControl.View>
                <dxg:TableView ShowGroupPanel="False"
                               AllowSorting="False"
                               ShowIndicator="False"
                               ShowHorizontalLines="True"
                               ShowVerticalLines="False"
                               AutoWidth="True">
                    <dxg:TableView.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="파일 제거"
                                      Command="{Binding RemoveFileCommand}" />
                        </ContextMenu>
                    </dxg:TableView.ContextMenu>
                </dxg:TableView>
            </dxg:GridControl.View>

            <dxg:GridColumn FieldName="FileName"
                            Header="파일명" />
            <dxg:GridColumn FieldName="AddedTime"
                            Header="추가 시간"
                            Width="60"
                            ReadOnly="True"
                            HorizontalHeaderContentAlignment="Center">
                <dxg:GridColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding RowData.Row.AddedTime, StringFormat=yyyy-MM-dd HH:mm:ss}"
                                   HorizontalAlignment="Center" />
                    </DataTemplate>
                </dxg:GridColumn.CellTemplate>
            </dxg:GridColumn>
            <dxg:GridColumn FieldName="SizeText"
                            Header="크기"
                            Width="50"
                            HorizontalHeaderContentAlignment="Center">
                <dxg:GridColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding RowData.Row.SizeText}"
                                   HorizontalAlignment="Right" />
                    </DataTemplate>
                </dxg:GridColumn.CellTemplate>
            </dxg:GridColumn>
            <!--<dxg:GridColumn FieldName="Extension"
                            Header="확장자" />-->
        </dxg:GridControl>

        <Border Grid.Row="0"
                Grid.Column="1"
                Background="#121A2B"
                CornerRadius="16"
                Padding="20"
                Margin="10">

            <StackPanel VerticalAlignment="Top">

                <Button Content="🔍 유사성 검사"
                        Height="42"
                        Margin="0,0,0,10"
                        Command="{Binding AnalyzeCommand}"
                        Style="{StaticResource PrimaryButton}" />

                <Button Content="🧹 리스트 초기화"
                        Height="42"
                        Background="#24314D"
                        Command="{Binding ClearCommand}"
                        Style="{StaticResource PrimaryButton}" />

                <!-- 확장용 -->
                <Separator Margin="0,20" />

                <CheckBox Content="표 내용 포함"
                          IsChecked="{Binding IncludeTable}"
                          Foreground="#EAF0FF" />

                <CheckBox Content="부분 일치 허용"
                          IsChecked="{Binding PartialMatch}"
                          Foreground="#EAF0FF" />
            </StackPanel>
        </Border>

        <dxg:GridControl Grid.Row="1"
                         Grid.ColumnSpan="2"
                         ItemsSource="{Binding SimilarityResults}"
                         Margin="0,10,0,0">

            <dxg:GridControl.View>
                <dxg:TableView ShowGroupPanel="False"
                               AllowSorting="True"
                               AutoWidth="True" />
            </dxg:GridControl.View>

            <dxg:GridColumn FieldName="SourceFile"
                            Header="기준 파일" />
            <dxg:GridColumn FieldName="TargetFile"
                            Header="비교 파일" />

            <dxg:GridColumn FieldName="Similarity"
                            Header="유사도 (%)"
                            Width="140">
                <dxg:GridColumn.CellTemplate>
                    <DataTemplate>
                        <ProgressBar Value="{Binding Similarity}"
                                     Maximum="100"
                                     Height="18" />
                    </DataTemplate>
                </dxg:GridColumn.CellTemplate>
            </dxg:GridColumn>

            <dxg:GridColumn FieldName="Result"
                            Header="판정"
                            Width="100" />
            <dxg:GridColumn FieldName="CheckedTime"
                            Header="검사 시각" />
        </dxg:GridControl>
    </Grid>
</UserControl>
